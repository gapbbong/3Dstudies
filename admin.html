<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>3D í”„ë¦°í„° í•™ìŠµ ê´€ë¦¬ì í˜ì´ì§€</title>
  <style>
    /* ì—¬ê¸°ì— CSS ìŠ¤íƒ€ì¼ë§ */
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
  </style>
</head>
<body>
  <h2>ğŸ“ ë°˜ë³„ ì˜¨ë„ ë­í‚¹ ì¡°íšŒ</h2>
  <label for="classIdInput">ë°˜ ID (ì˜ˆ: 25):</label>
  <input type="text" id="classIdInput" value="25" />
  <button onclick="loadClassRanking()">ì¡°íšŒ</button>
  
  <div id="rankingOutput"></div>

  <hr>

  <h2>ğŸ† ì „ì²´ ë¦¬ë”ë³´ë“œ</h2>
  <div id="leaderboardOutput"></div>

  <script>
    // 1. ë°˜ë³„ ë­í‚¹ ë¡œë“œ í•¨ìˆ˜
    function loadClassRanking() {
      const classId = document.getElementById('classIdInput').value;
      
      // Code.gsì˜ getClassTemperatureRanking(classId) í•¨ìˆ˜ í˜¸ì¶œ
      google.script.run
        .withSuccessHandler(displayRanking)
        .withFailureHandler(handleError)
        .getClassTemperatureRanking(classId);
    }

    // 2. ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„°ë¥¼ HTMLì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
    function displayRanking(data) {
      const outputDiv = document.getElementById('rankingOutput');
      let html = '<table><thead><tr><th>ì´ë¦„</th><th>ì˜¨ë„</th></tr></thead><tbody>';
      
      data.forEach(user => {
        html += `<tr><td>${user.name}</td><td>${user.temperature}Â°C</td></tr>`;
      });

      html += '</tbody></table>';
      outputDiv.innerHTML = html;
    }

    // 3. ì „ì²´ ë¦¬ë”ë³´ë“œ ë¡œë“œ í•¨ìˆ˜
    function loadLeaderboard() {
        google.script.run
        .withSuccessHandler(displayLeaderboard)
        .withFailureHandler(handleError)
        .getLeaderboard();
    }
    
    // 4. ë¦¬ë”ë³´ë“œ í‘œì‹œ í•¨ìˆ˜ (displayRankingê³¼ ìœ ì‚¬)
    function displayLeaderboard(data) {
      const outputDiv = document.getElementById('leaderboardOutput');
      // ... í…Œì´ë¸” ìƒì„± ë¡œì§ ...
      outputDiv.innerHTML = 'ì´ ' + data.length + 'ëª… ë°ì´í„° ë¡œë“œ ì™„ë£Œ.'; // ê°„ë‹¨íˆ í‘œì‹œ

    }
    
    // ì—ëŸ¬ ì²˜ë¦¬
    function handleError(error) {
      alert('ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¦¬ë”ë³´ë“œ ìë™ ë¡œë“œ
    window.onload = loadLeaderboard;
  </script>
</body>
</html>